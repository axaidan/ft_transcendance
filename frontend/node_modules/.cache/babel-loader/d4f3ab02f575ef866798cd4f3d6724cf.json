{"ast":null,"code":"var _jsxFileName = \"/front/src/componants/Friendsbar.tsx\",\n    _s = $RefreshSig$();\n\n// Extern:\nimport React from 'react';\nimport { useEffect, useState } from \"react\";\n// Intern:\nimport { AxiosJwt } from \"../hooks\";\n// Assets:\nimport '../styles/components/Friendsbar.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport function Friendsbar(_ref) {\n  _s();\n\n  let {\n    userId,\n    socket\n  } = _ref;\n  const [friends, setFriends] = useState([]);\n  const [connectFriends, setConnectFriends] = useState([]);\n  const axios = AxiosJwt();\n  useEffect(() => {\n    axios.get('/relation/list_friend').then(res => {\n      setFriends(res.data);\n    });\n  }, []);\n  useEffect(() => {\n    const connectedListener = connectId => {\n      const isFriend = friends.find(user => {\n        return user.id === connectId;\n      });\n      setConnectFriends(current => [...current, isFriend]);\n    };\n\n    const disconnectedListener = disconnectId => {\n      const isFriend = friends.find(user => {\n        return user.id === disconnectId;\n      });\n      setConnectFriends(prevMessages => {\n        const newMessages = { ...prevMessages\n        };\n        delete newMessages[isFriend.id];\n        return newMessages;\n      });\n    };\n\n    socket.on('loginToClient', connectId => {\n      const isFriend = friends.find(user => {\n        return user.id === connectId;\n      });\n      setConnectFriends(current => [...current, isFriend]);\n    });\n    socket.on('logoutToClient', disconnectedListener);\n    return () => {\n      socket.off('loginToClient', connectedListener);\n      socket.off('logoutToClient', disconnectedListener);\n    };\n  }, [socket]);\n  return /*#__PURE__*/_jsxDEV(\"nav\", {\n    className: \"Friendsbar\",\n    children: connectFriends.map(friend => /*#__PURE__*/_jsxDEV(\"div\", {\n      children: friend.username\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 5\n    }, this))\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 3\n  }, this);\n}\n\n_s(Friendsbar, \"0IU6gjsQ3OvOKEVb+BR15RowAHE=\");\n\n_c = Friendsbar;\n;\n\nvar _c;\n\n$RefreshReg$(_c, \"Friendsbar\");","map":{"version":3,"names":["React","useEffect","useState","AxiosJwt","Friendsbar","userId","socket","friends","setFriends","connectFriends","setConnectFriends","axios","get","then","res","data","connectedListener","connectId","isFriend","find","user","id","current","disconnectedListener","disconnectId","prevMessages","newMessages","on","off","map","friend","username"],"sources":["/front/src/componants/Friendsbar.tsx"],"sourcesContent":["// Extern:\nimport React from 'react';\nimport { useEffect, useState } from \"react\"\nimport { AxiosResponse } from \"axios\";\nimport { Socket } from 'socket.io-client';\n\n// Intern:\nimport { AxiosJwt } from \"../hooks\";\nimport { IUser } from '../types';\n\n// Assets:\nimport '../styles/components/Friendsbar.css'\n\ntype FriendbarProps = {\n\tuserId: number;\n\tsocket: Socket\n}\n\nexport function Friendsbar({ userId, socket }: FriendbarProps) {\n\tconst [friends, setFriends] = useState<IUser[]>([]);\n\tconst [connectFriends, setConnectFriends] = useState<IUser[]>([])\n\n\tconst axios = AxiosJwt();\n\n\tuseEffect(() => {\n\t\taxios.get('/relation/list_friend')\n\t\t\t.then((res: AxiosResponse<IUser[]>) => { setFriends(res.data) });\n\t}, []);\n\n\tuseEffect(() => {\n\t\tconst connectedListener = (connectId: number) => {\n\t\t\tconst isFriend = friends.find(user => {\n\t\t\t\treturn (user.id === connectId);\n\t\t\t})\n\t\t\tsetConnectFriends(current => [...current, isFriend!]);\n\t\t}\n\n\t\tconst disconnectedListener = (disconnectId: number) => {\n\t\t\tconst isFriend = friends.find(user => {\n\t\t\t\treturn (user.id === disconnectId);\n\t\t\t})\n\t\t\tsetConnectFriends((prevMessages) => {\n\t\t\t\tconst newMessages = { ...prevMessages };\n\t\t\t\tdelete newMessages[isFriend!.id];\n\t\t\t\treturn newMessages;\n\t\t\t});\n\t\t};\n\n\t\tsocket.on('loginToClient', (connectId: number) => {\n\t\t\tconst isFriend = friends.find(user => {\n\t\t\t\treturn (user.id === connectId);\n\t\t\t})\n\t\t\tsetConnectFriends(current => [...current, isFriend!]);\n\t\t});\n\t\t\n\t\tsocket.on('logoutToClient', disconnectedListener);\n\n\t\treturn () => {\n\t\t\tsocket.off('loginToClient', connectedListener);\n\t\t\tsocket.off('logoutToClient', disconnectedListener);\n\t\t};\n\t}, [socket]);\n\n\treturn (\n\t\t<nav className='Friendsbar'>\n\t\t\t{connectFriends.map((friend: IUser) => (\n\t\t\t\t<div>{friend.username}</div>\n\t\t\t))}\n\t\t</nav>\n\t);\n};"],"mappings":";;;AAAA;AACA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AAIA;AACA,SAASC,QAAT,QAAyB,UAAzB;AAGA;AACA,OAAO,qCAAP;;AAOA,OAAO,SAASC,UAAT,OAAwD;EAAA;;EAAA,IAApC;IAAEC,MAAF;IAAUC;EAAV,CAAoC;EAC9D,MAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBN,QAAQ,CAAU,EAAV,CAAtC;EACA,MAAM,CAACO,cAAD,EAAiBC,iBAAjB,IAAsCR,QAAQ,CAAU,EAAV,CAApD;EAEA,MAAMS,KAAK,GAAGR,QAAQ,EAAtB;EAEAF,SAAS,CAAC,MAAM;IACfU,KAAK,CAACC,GAAN,CAAU,uBAAV,EACEC,IADF,CACQC,GAAD,IAAiC;MAAEN,UAAU,CAACM,GAAG,CAACC,IAAL,CAAV;IAAsB,CADhE;EAEA,CAHQ,EAGN,EAHM,CAAT;EAKAd,SAAS,CAAC,MAAM;IACf,MAAMe,iBAAiB,GAAIC,SAAD,IAAuB;MAChD,MAAMC,QAAQ,GAAGX,OAAO,CAACY,IAAR,CAAaC,IAAI,IAAI;QACrC,OAAQA,IAAI,CAACC,EAAL,KAAYJ,SAApB;MACA,CAFgB,CAAjB;MAGAP,iBAAiB,CAACY,OAAO,IAAI,CAAC,GAAGA,OAAJ,EAAaJ,QAAb,CAAZ,CAAjB;IACA,CALD;;IAOA,MAAMK,oBAAoB,GAAIC,YAAD,IAA0B;MACtD,MAAMN,QAAQ,GAAGX,OAAO,CAACY,IAAR,CAAaC,IAAI,IAAI;QACrC,OAAQA,IAAI,CAACC,EAAL,KAAYG,YAApB;MACA,CAFgB,CAAjB;MAGAd,iBAAiB,CAAEe,YAAD,IAAkB;QACnC,MAAMC,WAAW,GAAG,EAAE,GAAGD;QAAL,CAApB;QACA,OAAOC,WAAW,CAACR,QAAQ,CAAEG,EAAX,CAAlB;QACA,OAAOK,WAAP;MACA,CAJgB,CAAjB;IAKA,CATD;;IAWApB,MAAM,CAACqB,EAAP,CAAU,eAAV,EAA4BV,SAAD,IAAuB;MACjD,MAAMC,QAAQ,GAAGX,OAAO,CAACY,IAAR,CAAaC,IAAI,IAAI;QACrC,OAAQA,IAAI,CAACC,EAAL,KAAYJ,SAApB;MACA,CAFgB,CAAjB;MAGAP,iBAAiB,CAACY,OAAO,IAAI,CAAC,GAAGA,OAAJ,EAAaJ,QAAb,CAAZ,CAAjB;IACA,CALD;IAOAZ,MAAM,CAACqB,EAAP,CAAU,gBAAV,EAA4BJ,oBAA5B;IAEA,OAAO,MAAM;MACZjB,MAAM,CAACsB,GAAP,CAAW,eAAX,EAA4BZ,iBAA5B;MACAV,MAAM,CAACsB,GAAP,CAAW,gBAAX,EAA6BL,oBAA7B;IACA,CAHD;EAIA,CAhCQ,EAgCN,CAACjB,MAAD,CAhCM,CAAT;EAkCA,oBACC;IAAK,SAAS,EAAC,YAAf;IAAA,UACEG,cAAc,CAACoB,GAAf,CAAoBC,MAAD,iBACnB;MAAA,UAAMA,MAAM,CAACC;IAAb;MAAA;MAAA;MAAA;IAAA,QADA;EADF;IAAA;IAAA;IAAA;EAAA,QADD;AAOA;;GApDe3B,U;;KAAAA,U;AAoDf"},"metadata":{},"sourceType":"module"}